import streamlit as st
import pandas as pd
import plotly.express as px

st.set_page_config(page_title="ğŸ“Š ë°ì´í„° ìƒê´€ê´€ê³„", page_icon="ğŸ“Š")

st.title("ğŸ“Š ë°ì´í„° ìƒê´€ê´€ê³„ ë¶„ì„ í˜ì´ì§€")

# --- ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ---
@st.cache_data
def load_data():
    return pd.read_csv("android-games.csv")

df = load_data()

# --- ìƒê´€ê´€ê³„ í–‰ë ¬ ---
st.subheader("ğŸ“ˆ ìƒê´€ê´€ê³„ íˆíŠ¸ë§µ")

numeric_df = df.select_dtypes(include=["int64", "float64"])

if not numeric_df.empty:
    corr = numeric_df.corr(numeric_only=True)
    fig = px.imshow(
        corr,
        text_auto=True,
        color_continuous_scale="RdBu_r",
        title="ìˆ˜ì¹˜í˜• ì»¬ëŸ¼ ê°„ ìƒê´€ê´€ê³„",
        aspect="auto"
    )
    fig.update_layout(
        paper_bgcolor="rgba(0,0,0,0)",
        plot_bgcolor="rgba(0,0,0,0)",
        font=dict(color="white"),
        title_font=dict(color="white")
    )
    st.plotly_chart(fig, use_container_width=True)
else:
    st.warning("âš ï¸ ìˆ˜ì¹˜í˜• ì»¬ëŸ¼ì´ ë¶€ì¡±í•˜ì—¬ ìƒê´€ê´€ê³„ë¥¼ ê³„ì‚°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")

# --- ì„ íƒí˜• ì‚°ì ë„ ë¶„ì„ ---
st.markdown("---")
st.subheader("ğŸ¯ íŠ¹ì • ë³€ìˆ˜ ê°„ ê´€ê³„ ì‹œê°í™”")

numeric_columns = numeric_df.columns.tolist()

if len(numeric_columns) >= 2:
    x_axis = st.selectbox("Xì¶• ë³€ìˆ˜ ì„ íƒ", numeric_columns)
    y_axis = st.selectbox("Yì¶• ë³€ìˆ˜ ì„ íƒ", numeric_columns, index=1)

    fig2 = px.scatter(
        df, x=x_axis, y=y_axis,
        trendline="ols",
        color_discrete_sequence=["#38bdf8"]
    )
    fig2.update_layout(
        paper_bgcolor="rgba(0,0,0,0)",
        plot_bgcolor="rgba(0,0,0,0)",
        font=dict(color="white"),
        title_font=dict(color="white")
    )
    st.plotly_chart(fig2, use_container_width=True)
else:
    st.info("ğŸ“Š ìƒê´€ ë¶„ì„ì„ ìœ„í•´ ìµœì†Œ 2ê°œ ì´ìƒì˜ ìˆ˜ì¹˜í˜• ì»¬ëŸ¼ì´ í•„ìš”í•©ë‹ˆë‹¤.")
